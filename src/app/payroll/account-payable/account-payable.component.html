
    <!-- Begin page -->
    <div id="layout-wrapper">
        <app-header></app-header>
        <!-- ========== App Menu ========== -->
        <app-sidemenu></app-sidemenu>
        <!-- Left Sidebar End -->
        <!-- Vertical Overlay-->
        <!-- ============================================================== -->
        <!-- Start right Content here -->
        <!-- ============================================================== -->
        <div class="main-content" style="overflow-x: hidden;">

            <div class="page-content">
                <div class="container-fluid">
                     <!-- start page title -->
                    <div class="row">
                        <div class="col-lg-12">
                            <div class="card mt-n4 mx-n4 mb-n5">
                                <div class="bg-info-subtle">
                                    <div class="card-body pb-2 mb-5">
                                        <div class="row">
                                            <div class="col-md">
                                                <div class="row align-items-center gy-2">
                                                    <div class="col-sm">
                                                    <div class="d-flex align-items-center ma-5">
                                                        <div class="flex-shrink-0">
                                                            <div class="avatar-sm">
                                                                <span class="avatar-title bg-info-subtle">
                                                                    <img src="assets\styles\img\icons8-accounts-64.png" alt="" width="120%">
                                                                </span>
                                                            </div>
                                                        </div>
                                                        <div class="flex-grow-1 ms-2 ma-5">
                                                            <h2 class="fs-16 mb-1 font-type fw-semibold text-uppercase">Payables</h2>
                                                        </div>
                                                    </div>
                                                    </div>
                                                    <div class="col-sm-auto">
                                                            <div class="flex-grow-1 ms-1 pr-20">
                                                                <div class="page-title-right padding-up-5">
                                                                    <a href="generate_payment" class="btn btn-orange btn-sm font-type fs-13 h-30 text-white" aria-label="Generate Reports">
                                                                        <i class="ri-folder-shared-line fs-18 align-bottom me-1"></i>
                                                                        <span>Generate Reports</span>
                                                                    </a>
                                                                </div>
                                                            </div>
                                                    </div>
                                                </div>
                                                </div>
                                                <!--end row-->
                                            </div>
                                        </div>
                                        <!--end row-->
                                    </div><!-- end card body -->
                            </div>
                        </div><!-- end card -->
                    </div>
                    <!-- End start page title -->
               
                    <!--End Radio Button Seletion-->
                    <div class="row gy-1 mb-3 ma-5">
                        <div class="col-lg-6 col-sm-6">
                            <div class="form-check card-radio-new shadow-lg card-animate bg-info">
                                <input id="Expense" name="select-type" type="radio" class="form-check-input p-3"  checked value="Expense" [(ngModel)]="user" (change)="radioselection(user)">
                                <label class="form-check-label p-2" for="Expense">
                                    <p class="text-uppercase fw-semibold fs-12 text-white font-type mb-1 ms-1 ma-5">Expense Claim</p>
                                </label>
                            </div>
                        </div>       
                        <div class="col-lg-6 col-sm-6">
                            <div class="form-check card-radio-new card-animate textbox-1 bg-info">
                                <input id="Loan" name="select-type" type="radio" class="form-check-input p-3" value="Loan" [(ngModel)]="user" (change)="radioselection(user)">
                                <label class="form-check-label p-2" for="Loan">
                                    <p class="text-uppercase fw-semibold fs-12 text-white font-type mb-1 ms-1 ma-5">Loan</p>
                                </label>
                            </div> 
                        </div>     
                    </div>
                    <!--End Radio Button Seletion-->

                    <!--EXPENSE-->
                    <div *ngIf="user==='Expense'">
                    <div id="Expense-data">
                    <div class="card bg-light-blue textbox-15">
                        <div class="card-body"> 
                            <!--Expense-Loan-filter-->
                            <div id="Expense-filter">
                                <div class="row mb-1 margin-up-10">
                                            <div class="col-lg-4 col-sm-6 col-md-6 pt-2">
                                                    <h6 class="fs-12 font-type fw-semibold"><span>Company</span></h6>
                                                    <select class="form-select font-type fs-12 textbox-15" id="exp_company" name="exp_company" (change)="FetchEmployeeList()">
                                                    <option  value="-1">All</option>
                                                    <option *ngFor="let CompanyaccList of listCompanyacc" value="{{CompanyaccList.KEY_ID}}">
                                                    {{CompanyaccList.DATA_VALUE}}
                                                    </option>
                                                    </select>       
                                            </div>
                                            <div class="col-lg-4 col-sm-6 col-md-6 pt-2">  
                                                    <h6 class="font-type fs-12 fw-semibold"><span>Employee</span></h6>
                                                    <select class="form-select font-type fs-12 textbox-15" id ="exp_employee" (change)="ExpenseClaimFilter()">
                                                        <option  value="-1">All</option>
                                                    <option *ngFor="let Listemployee of listemployee" value="{{Listemployee.EMP_CODE}}">
                                                    {{Listemployee.EMP_NAME}}
                                                    </option>
                                                    </select>                      
                                            </div>   
                                            <div class="col-lg-2 col-sm-6 col-md-6 pt-2">  
                                                <h6 class="font-type fs-12 fw-semibold"><span>From Date</span></h6>
                                                <input type="date" class="form-control font-type fs-11 mb-0" id="start-datepicker" id="fromdate" name="fromdate" [formControl]="fromdate" (change)="ExpenseClaimFilter()" > 
                                            </div>  
                                            <div class="col-lg-2 col-sm-6 col-md-6 pt-2">  
                                                <h6 class="font-type fs-12 fw-semibold"><span>To Date</span></h6>
                                                <input type="date" class="form-control font-type fs-11 mb-0" id="end-datepicker" id="todate" name="todate" [formControl]="todate"  (change)="ExpenseClaimFilter()">
                                            </div> 
                                </div>
                            </div>
                            <!--End Expense-filter-->
                        </div>
                    </div>

                    <!-- LIST FOR Expense Table -->
                    <div class="row margin-up-10" id="Expense-list">
                        <div class="col-lg-12">
                            <div class="card shadow-lg">
                                <div class="card-header border-0 pa-6-8">
                                    <div class="row align-items-center gy-3">
                                        <div class="col-sm">
                                            <div class="align-items-center d-flex ">
                                                <h4 class="card-title mb-0 flex-grow-1 fs-15 font-type fw-semibold">Expense Claim List</h4>
                                            </div>
                                        </div>
                                        <div class="col-sm-auto">
                                            <div class="d-flex gap-1 flex-wrap">
                                                <div class="search-box">
                                                    <input type="text" class="form-control search h-30 textbox-15 font-type" id="searchInput"  name="searchInput" placeholder="Search..." [(ngModel)]="searchInput"  >
                                                    <i class="ri-search-line search-icon"></i>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-lg-12">
                                    <div class="card-body">
                                            <div class="table-responsive table-card mb-0">
                                                <table class="table table-hover table-bordered table-nowrap align-middle border-orange">
                                                    <thead class="table-light text-white font-type border-orange" style="font-size:8px">
                                                        <tr>
                                                            <th data-sort="empcode" hidden>Emp Code</th>
                                                            <th class="fs-11">Co.</th>
                                                            <th class="fs-11">Dept</th>
                                                            <th class="fs-11">Employee</th>
                                                            <th class="text-center fs-11">Request<br>Date</th>
                                                            <th class="fs-11">Expense Category</th>
                                                            <th class="fs-11">Desc.</th>
                                                            <th class="fs-11">Amount</th>
                                                            <th class="fs-11">Currency</th>
                                                            <th class="text-center fs-11">Converted<br>Amount</th>
                                                            <th class="text-center fs-11">Payroll<br>Date</th>
                                                            <th class="fs-11">Doc.</th>
                                                        </tr>
                                                    </thead>
                                                    <tbody class=" font-type">
                                                        <tr *ngFor="let ExpenseClaimList of listexpenseclaim | search : searchInput | pagination: currentPage: itemsPerPage ;index as i">
                                                            <td class="fs-10" id="empcode" hidden>{{ExpenseClaimList.EMP_CODE}}</td>
                                                            <td class="fs-10" id="cmp">{{ExpenseClaimList.COMPANY_CODE}}</td>
                                                            <td class="fs-10" style="white-space: pre-wrap;" id="dept">{{ExpenseClaimList.DEPT_NAME}}</td>
                                                            <td class="fs-10" style="white-space: pre-wrap;" id="empname">{{ExpenseClaimList.EMP_NAME}}</td>
                                                            <td class="fs-10"id="reqdate">{{ExpenseClaimList.REQUEST_DATE| date: 'dd-MM-yyyy'}}</td>
                                                            <td class="fs-10"id="expcatgry">{{ExpenseClaimList.EXPENSE_CATEGORY}}</td>
                                                            <td><a href="#DescriptionModal" data-bs-toggle="modal" class="text-orange d-inline-block edit-item-btn ms-1 fs-12" style="text-decoration: underline;" (click)="selectDescription(ExpenseClaimList.DESCRIPTION)">View</a></td>
                                                            <td class="fs-10" id="amunt">{{ExpenseClaimList.AMOUNT}}</td>
                                                            <td class="fs-10"id="tbl_currency">{{ExpenseClaimList.CURRENCY}}</td>
                                                            <td class="fs-10" id="conv_amnt">{{ExpenseClaimList.CONVERTED_AMOUNT}}</td>
                                                            <td class="fs-10"id="paydate">{{ExpenseClaimList.PAYROLL_DATE| date: 'dd-MM-yyyy'}}</td>
                                                            <td class="text-center"id="td-ViewDocModal" > 
                                                                <a href="#ViewDocModal" title="View" data-bs-toggle="modal" class="bar-text d-inline-block edit-item-btn" (click)="ActivereqID(ExpenseClaimList.REQ_ID,ExpenseClaimList.DOCPATH)">
                                                                    <i class="ri-eye-fill fs-15 text-info"></i>
                                                                 </a>
                                                            </td>
                                                            
                                                        </tr>
                                                     
                                                    </tbody>
                                                </table>
                                            </div>
                                            <div *ngIf="listexpenseclaim">
                                                <div class="align-items-center justify-content-between row text-center text-sm-start"*ngIf="totalSearchResults>0">
                                                    <div class="col-sm">
                                                      <div class="font-type fs-12 text-muted">
                                                        Showing <span class="fw-semibold">{{ getEntriesStart() }}</span>
                                                        - <span class="fw-semibold">{{ getEntriesEnd() }}</span>
                                                        of <span class="fw-semibold">{{ totalSearchResults }}</span> Results
                                                      </div>
                                                    </div>
                                                    <div class="col-sm">
                                                        <div class="font-type fs-12 text-muted">
                                                            Total Pages : <span class="fw-semibold"> {{ getTotalPages() }}</span>
                                                        </div>
                                                    </div>
                                                    <div class="col-sm-auto mt-4 mt-sm-0">
                                                        <div class="d-flex gap-1 flex-wrap">
                                                            <div>
                                                                <div class="input-group">
                                                        <input type="number" class="form-control h-20 font-type" style="width:100px" aria-describedby="button-addon2" placeholder="Go to Page" [(ngModel)]="desiredPage" tabindex="1">                                                                    
                                                        
                                                       <button class="btn btn-orange text-white font-type fs-12 h-20" type="button" id="button-addon2"(click)="goToPage()" tabindex="2">Go</button>
                                                  </div>
                                                </div>
                                                     
                                                    <div class="col-sm-auto mt-3 mt-sm-0">
                                                      <ul class="pagination pagination-separated pagination-sm mb-0 justify-content-center">
                                                        <li class="page-item">
                                                          <button class="page-link" (click)="changePage(currentPage - 1)" [class.disabled-button]="currentPage === 1">←</button>
                                                        </li>
                                                        <ng-container *ngFor="let pageNumber of getPageNumbers(currentPage)">
                                                          <li class="page-item">
                                                            <button class="page-link" (click)="changePage(pageNumber)" [class.active]="currentPage === pageNumber">{{ pageNumber }}</button>
                                                          </li>
                                                        </ng-container>
                                                        <li class="page-item">
                                                          <button class="page-link" (click)="changePage(currentPage + 1)" [class.disabled-button]="currentPage * itemsPerPage >= totalSearchResults">→</button>
                                                        </li>
                                                      </ul>
                                                    </div>
                                                  </div>
                                        </div>
                                    </div>
                                            </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <!--end col-->
                    </div>
                    <!-- End LIST FOR Expense Table -->
                    </div>
                    </div>
                    <!--END EXPENSE-->

                     <!--LOAN-->
                    <div *ngIf="user==='Loan'">
                    <div id="Loan-data" >
                        <div class="card bg-light-blue textbox-15">
                            <div class="card-body"> 
                                <!--Loan-filter-->
                                    <div class="row mb-1 margin-up-10">
                                                <div class="col-lg-3 col-sm-6 col-md-6 pt-2">
                                                        <h6 class="fs-12 font-type fw-semibold"><span>Company</span></h6>
                                                        <select class="form-select font-type textbox-15 fs-11"  id="ln_cmpny" (change)="FetchEmployeeList()">
                                                            <option  value="-1" [defaultSelected]>All</option>
                                                            <option *ngFor="let CompanyaccList of listCompanyacc" value="{{CompanyaccList.KEY_ID}}">
                                                            {{CompanyaccList.DATA_VALUE}}
                                                            </option>
                                                        </select>       
                                                </div>
                                                <div class="col-lg-3 col-sm-6 col-md-6 pt-2">  
                                                        <h6 class="font-type fs-12 fw-semibold"><span>Employee</span></h6>
                                                        <select class="form-select font-type fs-11 textbox-15" id="ln_employee" (change)="LoanFilter()">
                                                            <option  value="-1">All</option>
                                                            <option *ngFor="let Listemployee of listemployee" value="{{Listemployee.EMP_CODE}}">
                                                            {{Listemployee.EMP_NAME}}
                                                    </option>  
                                                        </select>                      
                                                </div>   
                                                <div class="col-lg-2 col-sm-4 col-md-4 pt-2">
                                                    <h6 class="fs-12 font-type fw-semibold"><span>Status</span></h6>
                                                    <select class="form-select font-type fs-11 textbox-15" id="ln_status" (change)="LoanFilter()">
                                                        <option  value="-1">All</option>
                                                            <option *ngFor="let Liststatus of liststatusloan" value="{{Liststatus.KEY_ID}}">
                                                            {{Liststatus.DATA_VALUE}}
                                                    </select>       
                                            </div>
                                                <div class="col-lg-2 col-sm-4 col-md-4 pt-2">  
                                                    <h6 class="font-type fs-12 fw-semibold"><span>From Date</span></h6>
                                                    <input type="date" class="form-control font-type fs-11 mb-0" id="lfromdate" name="lfromdate" [formControl]="lfromdate" (change)="LoanFilter()"  >                                        
                                                </div>  
                                                <div class="col-lg-2 col-sm-4 col-md-4 pt-2">  
                                                    <h6 class="font-type fs-12 fw-semibold"><span>To Date</span></h6>
                                                    <input type="date" class="form-control font-type fs-11 mb-0"  id="ltodate" name="ltodate" [formControl]="ltodate" (change)="LoanFilter()" >                                     
                                                </div> 
                                    </div>
                                <!--End Loan-filter-->
                            </div>
                        </div>
    
                        <!-- LIST FOR Loan Table -->
                        <div class="row margin-up-10">
                            <div class="col-lg-12">
                                <div class="card shadow-lg">
                                    <div class="card-header border-0 pa-6-8">
                                        <div class="row align-items-center gy-3">
                                            <div class="col-sm">
                                                <div class="align-items-center d-flex ">
                                                    <h4 class="card-title mb-0 flex-grow-1 fs-15 font-type fw-semibold">Loan List</h4>
                                                </div>
                                            </div>
                                            <div class="col-sm-auto">
                                                <div class="d-flex gap-1 flex-wrap">
                                                    <div class="search-box">
                                                        <input type="text" class="form-control search h-30 textbox-15 font-type" id="searchInputloan"  name="searchInputloan" placeholder="Search..." [(ngModel)]="searchInputloan" (keyup)="changePageLoan(currentPageloan)" >
                                                        <i class="ri-search-line search-icon"></i>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-lg-12">
                                        <div class="card-body">
                                                <div class="table-responsive table-card mb-0">
                                                    <table class="table table-hover table-bordered table-nowrap align-middle border-orange">
                                                        <thead class="table-light text-white font-type border-orange" style="font-size:8px">
                                                            <tr >
                                                                <th class="fs-11" hidden>Emp code</th>
                                                                <th class="fs-11" hidden>Req Id</th>
                                                                <th class="fs-11">Co.</th>
                                                                <th class="fs-11">Dept</th>
                                                                <th class="fs-11">Employee</th>
                                                                <th class="fs-11">Amount</th>
                                                                <th class="text-center fs-11">No of<br>Inst.</th>
                                                                <th class="text-center fs-11">Inst.<br>Amount</th>
                                                                <th class="text-center fs-11">DSB Month &<br>Year</th>
                                                                <th class="text-center fs-11">DSB St. Month<br> & Year</th>
                                                                <th class="fs-11">Remarks</th>
                                                                <th class="fs-11">Status</th>
                                                                <th class="fs-11">Details</th>
                                                            </tr>
                                                        </thead>
                                                        <tbody class=" font-type">
                                                            <tr *ngFor="let LoanList of listloan | search : searchInputloan | pagination: currentPageloan: itemsPerPage ;index as i">
                                                                <td class="fs-10" hidden>{{LoanList.EMP_CODE}}</td>
                                                                <td class="fs-10" hidden>{{LoanList.REQ_ID}}</td>
                                                                <td class="fs-10">{{LoanList.COMPANY_CODE}}</td>
                                                                <td class="fs-10" style="white-space: pre-wrap;">{{LoanList.DEPT_NAME}}</td>
                                                                <td class="fs-10" style="white-space: pre-wrap;">{{LoanList.EMP_NAME}}</td>
                                                                <td class="fs-10">{{LoanList.AMOUNT}}</td>
                                                                <td class="fs-10 text-center">{{LoanList.noOfInstal}}</td>
                                                                <td class="fs-10">{{LoanList.Instal_Amnt}}</td>
                                                                <td class="fs-10 text-center">{{LoanList.dSMonth}} {{LoanList.dSYear}}</td>
                                                                <td class="fs-10 text-center">{{LoanList.dSBMonth}} {{LoanList.dSBYear}}</td>
                                                                <td><a href="#RemarksModal" data-bs-toggle="modal" class="textblack"(click)="selectRemarks(LoanList.CLOSE_REMARKS)">{{LoanList.CLOSE_REMARKS ? LoanList.CLOSE_REMARKS.substring(0, 4) : ''}}</a></td>
                                                                <!-- <td class="text-center"><a href="#RemarksModal" data-bs-toggle="modal" class="text-orange d-inline-block edit-item-btn ms-1 fs-12" style="text-decoration: underline;">View</a></td> -->
                                                                <td class="fs-10">{{LoanList.APPROVED_STATUS}}</td>
                                                                <td class="text-center">
                                                                    <a href="#" title="View">
                                                                        <i class="ri-eye-fill fs-15 text-info" data-bs-toggle="modal" data-bs-target="#AddRequestModal" (click)="Fetchloanpayments(LoanList.EMP_CODE,LoanList.REQ_ID)"></i>
                                                                     </a>
                                                                </td>
                                                                
                                                            </tr>
                                                            
                                                        </tbody>
                                                    </table>
                                                </div>
                                                <div *ngIf="listloan">
                                                    <div class="align-items-center justify-content-between row text-center text-sm-start"*ngIf="totalSearchResultsloan>0">
                                                        <div class="col-sm">
                                                          <div class="font-type fs-12 text-muted">
                                                            Showing <span class="fw-semibold">{{ getEntriesStartLoan() }}</span>
                                                            - <span class="fw-semibold">{{ getEntriesEndLoan() }}</span>
                                                            of <span class="fw-semibold">{{ totalSearchResultsloan }}</span> Results
                                                          </div>
                                                        </div>
                                                        <div class="col-sm">
                                                            <div class="font-type fs-12 text-muted">
                                                                Total Pages : <span class="fw-semibold"> {{ getTotalPagesLoan() }}</span>
                                                            </div>
                                                        </div>
                                                        <div class="col-sm-auto mt-4 mt-sm-0">
                                                            <div class="d-flex gap-1 flex-wrap">
                                                                <div>
                                                                    <div class="input-group">
                                                            <input type="number" class="form-control h-20 font-type" style="width:100px" aria-describedby="button-addon2" placeholder="Go to Page" [(ngModel)]="desiredPageloan" tabindex="1">                                                                    
                                                            
                                                           <button class="btn btn-orange text-white font-type fs-12 h-20" type="button" id="button-addon2"(click)="goToPageLoan()" tabindex="2">Go</button>
                                                      </div>
                                                    </div>
                                                         
                                                        <div class="col-sm-auto mt-3 mt-sm-0">
                                                          <ul class="pagination pagination-separated pagination-sm mb-0 justify-content-center">
                                                            <li class="page-item">
                                                              <button class="page-link" (click)="changePageLoan(currentPageloan - 1)" [class.disabled-button]="currentPageloan === 1">←</button>
                                                            </li>
                                                            <ng-container *ngFor="let pageNumber of getPageNumbersLoan(currentPageloan)">
                                                              <li class="page-item">
                                                                <button class="page-link" (click)="changePageLoan(pageNumber)" [class.active]="currentPageloan === pageNumber">{{ pageNumber }}</button>
                                                              </li>
                                                            </ng-container>
                                                            <li class="page-item">
                                                              <button class="page-link" (click)="changePageLoan(currentPage + 1)" [class.disabled-button]="currentPageloan * itemsPerPage >= totalSearchResultsloan">→</button>
                                                            </li>
                                                          </ul>
                                                        </div>
                                                      </div>
                                            </div>
                                        </div>
                                                </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <!--end col-->
                        </div>
                        <!-- End LIST FOR Expense Table -->
                    </div>
                    </div>
                    <!--END LOAN-->

                    <!--No Data Message-->
                    <!--<div class="py-2 text-center">
                        <lord-icon src="https://cdn.lordicon.com/msoeawqm.json" trigger="loop" colors="primary:#405189,secondary:#0ab39c" style="width:72px;height:72px">
                        </lord-icon>
                        <h5 class="mt-1 font-type fw-semibold fs-18">Error: No Result Found!</h5>        
                    </div>-->


                </div>
                 <!--END container-fluid-->
            </div>
            <!--END page-content-->

                    <!--MODAL BOXES-->

                           <!-- Detailed Description Modal-->
                           <div class="modal fade zoomIn" id="DescriptionModal" tabindex="-1" aria-labelledby="DetailedDescriptionModal" aria-hidden="true">
                            <div class="modal-dialog modal-dialog-centered">
                                <div class="modal-content">
                                    <div class="modal-header bg-orange padding-up-5">
                                        <h5 class="fs-13 font-type text-white ma-5 fw-semibold">Description</h5>
                                        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close" id="close-modal"></button>
                                    </div>
                                    <div class="modal-body pa-6-8">
                                        <label class="form-label font-type ma-5">
                                            <span class="mb-3 fs-12">{{description}}</span>
                                        </label>         
                                    </div>
                                </div>
                            </div>
                           </div>
                         <!-- End Detailed Description  Modal-->



                            <!-- Remarks Modal-->
                            <div class="modal fade zoomIn" id="RemarksModal" tabindex="-1" aria-labelledby="RemarksModal" aria-hidden="true">
                                    <div class="modal-dialog modal-dialog-centered modal-lg">
                                        <div class="modal-content">
                                            <div class="modal-header bg-orange padding-up-5"> 
                                                <h5 class="fs-13 font-type text-white ma-5 fw-semibold">Remarks</h5>
                                                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close" id="close-modal"></button>
                                            </div>
                                            <div class="modal-body pa-6-8">
                                                <label class="form-label font-type ma-5" style="text-align: justify;">
                                                    <span class="mb-3 fs-12">{{remarks}}</span>
                                                </label>         
                                            </div>
                                        </div>
                                    </div>
                            </div>
                            <!-- End Remarks Modal-->
                              <!-- View details modal -->
                            <div class="modal fade" id="AddRequestModal" tabindex="-1" aria-labelledby="AddRequestModal" aria-hidden="true">
                                <div class="modal-dialog modal-dialog-centered">
                                    <div class="modal-content">
                                        <div class="modal-header bg-orange padding-up-5">
                                            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close" id="close-modal" ></button>
                                        </div>
                                        <div class="modal-body ">
                                            <div class="">
                                        <div class="row align-items-center mb-4 padding-up-5">
                                            <div class="col-sm">
                                                <div class="align-items-center d-flex ">
                                                    <h4 class="card-title mb-0 flex-grow-1 fs-13 font-type fw-semibold" style="text-decoration:underline;float: left;">Loan Repayment Details</h4>
                                                </div>
                                            </div>
                                            <div class="col-sm-auto">
                                                <div class="d-flex gap-1 flex-wrap">
                                                    <h5 class="font-type fw-semibold fs-13 padding-up-5">Disbursement Date : <span class="text-orange">{{DISBURSEMENT_DATE | date: 'dd-MM-yyyy'}}</span></h5>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="table-responsive table-card mb-1">
                                            <table class="table table-nowrap align-middle" id="orderTable">
                                                <thead class="font-type text-white" style="background-color:#fa9d5e">
                                            <tr>
                                                <th>Payment Date</th>
                                                <th>Payment Amount</th>
                                                <th>Balance</th>
                                            </tr>
                                            </thead>
                                            <tbody>
                                                <tr *ngFor="let payments of paymentdetails">
                                                    <td>{{payments.Payment_Date | date:"dd"}} {{payments.Payment_Date | date:"MMM"}}, {{payments.Payment_Date | date:"YYYY"}}</td>
                                                    <td>{{payments.Payment_Amnt}}</td>
                                                    <td>{{payments.Balance_Amnt}}</td>
                                                </tr>
                                            </tbody>
                                        </table>
                                    </div> 
                                    </div>
                                    </div>
                                </div>
                            </div> 
                            </div>
                            <!--End View details modal -->
<!--Modal For Success Message Start-->
<div class="modal fade zoomIn" id="SuccessRecordModal" tabindex="-1" aria-labelledby="deleteRecordLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content">
            <div class="modal-header bg-orange padding-up-5">
                <h5 class="modal-title" id="exampleModalLabel">&nbsp;</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close" id="close-modal"></button>
            </div>
            <div class="modal-body" *ngIf="showModal==1"> 
                <div class="container">
                    <h2 class="text-center" style="font-size: 12px;"><i class="fa fa-check-circle text-success" style="font-size: 25px;" style="font-size: 12px;"></i> {{success}}</h2>
            
                </div>
            </div>
            <div class="modal-body" *ngIf="showModal==2">
            <div class="container">
                <h2 class="text-center" style="font-size: 12px;"><i class="fa fa-times-circle text-danger" style="font-size: 25px;" style="font-size: 12px;"></i> {{failed}}</h2>
                
            </div>
        </div>
        </div>
    </div>
</div>
<div class="modal fade" id="ViewDocModal" tabindex="-1" aria-labelledby="ViewDocModal" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content">
            <div class="modal-header bg-orange padding-up-5">
                
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close" id="close-modal"></button>
            </div>
            <form class="tablelist-form" autocomplete="off">
                <div class="modal-body">
                    <input type="hidden" id="id-field" />
                        <h6 class="mb-3 fw-semibold text-uppercase font-type">Documents</h6>
                        <div class="row g-3">
                            <div class="col-xxl-4 col-lg-12">
                                <div class="border rounded border-dashed p-2">
                                    <div class="d-flex align-items-center">
                                        <div class="flex-shrink-0 me-3">
                                            <div class="avatar-sm">
                                                <div class="avatar-title bg-light text-secondary rounded fs-24">
                                                    <i class="ri-folder-zip-line"></i>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="flex-shrink-0 ms-2">
                                            <div class="d-flex gap-1">
                                                <!-- <a href="https://localhost:44381/api/File/GetLeavDocs/{{activereqid}}" download target="_blank"><button type="button" class="btn btn-icon text-muted btn-sm fs-18"><i class="ri-download-2-line"></i></button></a> -->
                                               
                                                    <a href="#ViewDocModal">
                                                    <button class="btn btn-icon text-muted btn-sm fs-18 dropdown" type="button" (click)="download_to_excel()" data-bs-toggle="modal" data-bs-target="#ViewDocModal">
                                                        <i class="ri-eye-line"></i>
                                                    </button>
                                                </a>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <!-- end row -->
                </div>  
            </form>
        </div>
    </div>
</div>
<!--Modal For Success Message End-->
     
        <app-footer></app-footer>   
        </div>
        <!-- end main content-->

    </div>
    <!-- END layout-wrapper -->

    
